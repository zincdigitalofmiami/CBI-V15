# Big 8 Bucket Feature Selectors
# ADDITIVE MODEL: All buckets get core macro/FX base + bucket-specific features
#
# Architecture:
# - LAYER 1: Core Macro/FX (ALL buckets get these ~50 features)
# - LAYER 2: Bucket-specific (ADDED on top)
#
# This is NOT feature selection, it's feature ADDITION.
# Each bucket sees common macro context + its specialized drivers.

# =============================================================================
# LAYER 1: CORE MACRO/FX BASE (ALL BUCKETS INHERIT)
# =============================================================================
core_macro_fx:
  # FX Features (7 must-haves from FX_INDICATORS_INDUSTRY_REVIEW.md)
  - fred_rate_differential_brl_us  # BRL-US carry trade
  - fx_brl_momentum_21d
  - fx_brl_momentum_63d
  - fx_brl_momentum_252d
  - fx_dxy_momentum_21d
  - fx_dxy_momentum_63d
  - fx_dxy_momentum_252d
  - fx_brl_volatility_21d
  - fx_brl_volatility_63d
  - corr_zl_brl_30d  # ZL-BRL correlation
  - corr_zl_brl_60d
  - corr_zl_brl_90d
  - corr_zl_dxy_30d  # ZL-DXY correlation
  - corr_zl_dxy_60d
  - corr_zl_dxy_90d
  - terms_of_trade  # Export/import price ratio
  
  # Macro Features (FRED)
  - fred_FEDFUNDS  # Fed funds rate
  - fred_DFEDTARU  # Fed funds target (upper bound)
  - fred_DGS10  # 10Y Treasury yield
  - fred_T10Y2Y  # Yield curve slope
  - fred_T10Y3M  # Short-term curve
  - fred_NFCI  # Financial conditions
  - fred_STLFSI4  # Financial stress
  - fred_VIXCLS  # VIX (volatility index)
  - fred_UNRATE  # Unemployment rate
  - fred_CPIAUCSL  # CPI (inflation)
  
  # Price/Volume Base
  - databento_zl_close  # Primary target
  - databento_zl_volume
  - databento_zl_open_interest

# =============================================================================
# LAYER 2: BUCKET-SPECIFIC ADDITIONS
# =============================================================================

# Bucket 1: CRUSH (Board crush, oil share, spreads)
crush:
  base: core_macro_fx  # Inherits all ~50 core features
  additional:  # ADDS these ~20 features
    - databento_zs_close  # Soybeans
    - databento_zm_close  # Soy meal
    - board_crush  # (ZM × 0.022 + ZL × 11) - ZS
    - oil_share  # (ZL × 11) / Board_Crush_Value
    - hog_spread  # HE - (0.8 × ZC + 0.2 × ZM)
    - databento_he_close  # Lean hogs
    - databento_zc_close  # Corn
    - soybean_crush_margin
    - oil_share_momentum_21d
    - board_crush_percentile_252d

# Bucket 2: CHINA (Export sales, HG-ZS correlation, trade policy)
china:
  base: core_macro_fx
  additional:  # ADDS these ~15 features
    - databento_hg_close  # Copper (China green infrastructure proxy)
    - corr_hg_zs_60d  # China Pulse
    - usda_export_soybeans_weekly  # Weekly export sales (LAST_VALUE filled)
    - usda_export_china_pct  # China as % of total exports
    - farm_policy_news_trade_sentiment  # Real-time China policy
    - china_demand_proxy
    - hg_momentum_21d
    - export_sales_momentum_4w

# Bucket 3: FX (Additional currency pairs, multi-pair correlations)
fx:
  base: core_macro_fx  # Already has 7 FX must-haves
  additional:  # ADDS these ~10 features
    - databento_6e_close  # Euro
    - databento_6j_close  # Yen
    - databento_6m_close  # MXN
    - fx_cny_momentum_21d  # CNY (if available)
    - fx_mxn_momentum_21d
    - corr_zl_cny_60d
    - corr_zl_mxn_60d
    - fx_regime_indicator
    - multi_currency_stress_index

# Bucket 4: FED (Fed policy, yield curve, financial conditions)
fed:
  base: core_macro_fx  # Already has Fed funds, yields, NFCI, STLFSI4
  additional:  # ADDS these ~15 features
    - fed_pivot_probability  # Fed pivot indicator
    - farm_policy_news_budget_sentiment  # Budget/fiscal policy
    - fed_speech_sentiment  # If available
    - fomc_minutes_hawkish_score  # If available
    - rate_momentum_21d
    - yield_curve_momentum_63d
    - nfci_percentile_252d
    - stlfsi4_percentile_252d

# Bucket 5: TARIFF (Trump sentiment, trade policy, Section 301)
tariff:
  base: core_macro_fx
  additional:  # ADDS these ~20 features
    - scrc_tariffs_trade_sentiment  # ScrapeCreators tariff bucket
    - farm_policy_news_trade_sentiment  # Farm Policy News trade category
    - trump_truth_social_tariff_mentions  # Trump posts
    - section_301_indicator  # Section 301 tariff status
    - trade_policy_uncertainty_index
    - tariff_rate_changes
    - china_tariff_mentions_7d
    - soybean_tariff_exposure

# Bucket 6: BIOFUEL (EPA RIN prices, BOHO spread, biodiesel, RFS)
biofuel:
  base: core_macro_fx
  additional:  # ADDS these ~25 features (weekly→daily filled!)
    - epa_rin_d3_price_filled  # LAST_VALUE filled to daily
    - epa_rin_d4_price_filled  # LAST_VALUE filled to daily
    - epa_rin_d5_price_filled  # LAST_VALUE filled to daily
    - epa_rin_d6_price_filled  # LAST_VALUE filled to daily
    - boho_spread  # (ZL/100 × 7.5) - HO (Soy Oil vs Heating Oil)
    - databento_ho_close  # Heating oil
    - eia_biodiesel_prod  # Monthly biodiesel production (filled)
    - eia_biodiesel_consumption  # Monthly consumption (filled)
    - eia_rfs_volumes  # RFS mandates (filled)
    - farmdoc_daily_rin_analysis_sentiment  # Scott Irwin RIN models
    - rin_d4_momentum_4w
    - rin_d4_volatility_12w
    - boho_spread_zscore_252d
    - biodiesel_prod_yoy

# Bucket 7: ENERGY (CL/HO/RB, crack spreads, CL-ZL correlation)
energy:
  base: core_macro_fx
  additional:  # ADDS these ~20 features
    - databento_cl_close  # WTI crude
    - databento_ho_close  # Heating oil
    - databento_rb_close  # RBOB gasoline
    - crack_spread_3_2_1  # 3 barrels crude → 2 gas + 1 distillate
    - crack_spread_5_3_2  # 5 barrels crude → 3 gas + 2 distillate
    - corr_cl_zl_60d  # Crude-ZL correlation (energy substitute)
    - ho_rb_spread  # Heating oil - gasoline
    - crude_momentum_21d
    - crack_spread_momentum_21d
    - energy_substitute_index

# Bucket 8: VOLATILITY (VIX, realized vol, stress indices, regime)
volatility:
  base: core_macro_fx  # Already has VIXCLS, STLFSI4
  additional:  # ADDS these ~15 features
    - volatility_zl_21d  # Garman-Klass estimator
    - volatility_zl_63d
    - volatility_zs_21d  # Soybean volatility
    - vix_term_structure  # VIX futures curve
    - vix_percentile_252d
    - realized_vol_parkinson
    - correlation_regime  # Correlation shift indicator
    - stress_propagation_index
    - tail_risk_indicator

# =============================================================================
# MAIN ZL PREDICTOR: ALL FEATURES (No Specialization)
# =============================================================================
main:
  # Sees everything from all buckets (~300 features)
  base: core_macro_fx
  additional:
    - ALL features from crush, china, fx, fed, tariff, biofuel, energy, volatility
    # Main predictor has full 360-degree view
    # No bucket specialization, just raw predictive power












