# ============================================================================
# CBI-V15 Ingestion Schedule Configuration
# ============================================================================
# Runtime: GitHub Actions (cloud) or local cron
# Database: DuckDB (local) / MotherDuck (cloud)
# NO Google Cloud Functions, NO Dataform
# ============================================================================

# ============================================================================
# MARKET DATA (Databento)
# ============================================================================

databento_zl_price:
  name: "databento-zl-price-hourly"
  schedule: "0 * * * *" # Every hour
  timezone: "America/New_York"
  script: "src/ingestion/databento/collect_hourly.py"
  payload:
    symbol: "ZL"
    frequency: "1h"

databento_other_symbols:
  name: "databento-other-symbols-4hourly"
  schedule: "0 */4 * * *" # Every 4 hours
  timezone: "America/New_York"
  script: "src/ingestion/databento/collect_hourly.py"
  payload:
    symbols: ["ZS", "ZM", "CL", "HO", "FCPO", "ZC", "HE", "6L", "DX", "HG", "GC"]
    frequency: "4h"

# ============================================================================
# FRED MACRO DATA
# ============================================================================

fred_macro_daily:
  name: "fred-macro-daily"
  schedule: "0 18 * * *" # Daily at 6 PM ET (after market close)
  timezone: "America/New_York"
  script: "src/ingestion/fred/collect_fred_rates_curve.py"
  payload:
    series_count: 60

# ============================================================================
# NEWS/SENTIMENT BUCKETS (ScrapeCreators)
# ============================================================================

scrapecreators_news_buckets:
  name: "scrapecreators-news-buckets-hourly"
  schedule: "0 * * * *" # Every hour
  timezone: "America/New_York"
  script: "src/ingestion/scrapecreators/collect_news_buckets.py"
  payload:
    buckets: ["biofuel_policy", "china_demand", "tariffs_trade_policy"]
    segment_at_ingestion: true
    calculate_sentiment: true

scrapecreators_trump:
  name: "scrapecreators-trump-hourly"
  schedule: "0 * * * *" # Every hour
  timezone: "America/New_York"
  script: "src/ingestion/scrapecreators/collect_trump_truth_social.py"
  payload:
    source: "truth_social"
    calculate_zl_impact: true

# ============================================================================
# USDA DATA
# ============================================================================

usda_reports:
  name: "usda-reports-weekly"
  schedule: "0 10 * * 1" # Monday at 10 AM ET
  timezone: "America/New_York"
  script: "src/ingestion/usda/ingest_wasde.py"
  payload:
    report_types: ["WASDE", "crop_progress", "export_sales"]

# ============================================================================
# CFTC DATA
# ============================================================================

cftc_cot:
  name: "cftc-cot-weekly"
  schedule: "0 10 * * 5" # Friday at 10 AM ET
  timezone: "America/New_York"
  script: "src/ingestion/cftc/ingest_cot.py"
  payload:
    extract_managed_money: true
    zl_specific: true

# ============================================================================
# EIA DATA
# ============================================================================

eia_biofuels:
  name: "eia-biofuels-weekly"
  schedule: "0 10 * * 3" # Wednesday at 10 AM ET
  timezone: "America/New_York"
  script: "src/ingestion/eia_epa/collect_eia_biofuels.py"
  payload:
    series: ["rin_prices_d4", "rin_prices_d6", "biodiesel_production", "rfs_volumes"]

# ============================================================================
# WEATHER DATA
# ============================================================================

weather_noaa:
  name: "weather-noaa-daily"
  schedule: "0 2 * * *" # Daily at 2 AM ET
  timezone: "America/New_York"
  script: "src/ingestion/weather/collect_all_weather.py"
  payload:
    sources: ["NOAA"]
    aggregate_by_region: true

# ============================================================================
# FEATURE COMPUTATION (DuckDB SQL Macros)
# ============================================================================

anofox_features_daily:
  name: "anofox-features-daily"
  schedule: "0 3 * * *" # Daily at 3 AM ET (after all ingestion complete)
  timezone: "America/New_York"
  script: "src/engines/anofox/build_all_features.py"
  payload:
    workflow: "staging_to_features"
    verify_data_quality: true

anofox_ml_matrix:
  name: "anofox-ml-matrix-daily"
  schedule: "0 4 * * *" # Daily at 4 AM ET (after features computed)
  timezone: "America/New_York"
  script: "src/engines/anofox/build_training.py"
  payload:
    workflow: "build_daily_ml_matrix"
    verify_data_quality: true
